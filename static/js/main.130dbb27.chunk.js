(this["webpackJsonp@riverscapes/rs-maps"]=this["webpackJsonp@riverscapes/rs-maps"]||[]).push([[0],{288:function(e,t){},535:function(e,t,a){e.exports=a(841)},564:function(e,t){},566:function(e,t){},836:function(e,t,a){},841:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(35),c=a.n(r),i=a(120),s=a(159),l=a(87),m=a(55),u=a(295),p=a(858),d=a(889),h=a(888),f=a(891),b=a(144),g=a(145),E=a(388),O=a(50),y=a.n(O);var _="pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",v=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_RS_TILES_CDN:"https://d2hsyhl6qlaiyu.cloudfront.net",REACT_APP_BRAT_CDN:"https://d18emzkyqtselk.cloudfront.net",REACT_APP_AWS_REGION_DEPLOY:"us-west-2",REACT_APP_AWS_USERPOOLID:"us-west-2_jkK8HRXBU",REACT_APP_AWS_USERPOOLWEBCLIENTID:"6spmepn7s5nddcjbmd410sq40c",REACT_APP_HOSTED_DOMAIN:"riverscapes-prod.auth.us-west-2.amazoncognito.com"}).REACT_APP_VERSION,S=(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_RS_TILES_CDN:"https://d2hsyhl6qlaiyu.cloudfront.net",REACT_APP_BRAT_CDN:"https://d18emzkyqtselk.cloudfront.net",REACT_APP_AWS_REGION_DEPLOY:"us-west-2",REACT_APP_AWS_USERPOOLID:"us-west-2_jkK8HRXBU",REACT_APP_AWS_USERPOOLWEBCLIENTID:"6spmepn7s5nddcjbmd410sq40c",REACT_APP_HOSTED_DOMAIN:"riverscapes-prod.auth.us-west-2.amazoncognito.com"}).REACT_APP_GRAPHQL,Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_RS_TILES_CDN:"https://d2hsyhl6qlaiyu.cloudfront.net",REACT_APP_BRAT_CDN:"https://d18emzkyqtselk.cloudfront.net",REACT_APP_AWS_REGION_DEPLOY:"us-west-2",REACT_APP_AWS_USERPOOLID:"us-west-2_jkK8HRXBU",REACT_APP_AWS_USERPOOLWEBCLIENTID:"6spmepn7s5nddcjbmd410sq40c",REACT_APP_HOSTED_DOMAIN:"riverscapes-prod.auth.us-west-2.amazoncognito.com"}).REACT_APP_CDN,new URL("".endsWith("/")?"":"/",window.location.origin)),j={Auth:{region:"us-west-2",userPoolId:"us-west-2_jkK8HRXBU",userPoolWebClientId:"6spmepn7s5nddcjbmd410sq40c",mandatorySignIn:!0,oauth:{domain:"riverscapes-prod.auth.us-west-2.amazoncognito.com",scope:["email","profile","openid"],redirectSignIn:S,redirectSignOut:S,responseType:"code"}}},A=function(e,t,a){console.log("vbetStyle");var n=e.tiles.reduce((function(e,t){return Object(m.a)(Object(m.a)({},e),{},Object(s.a)({},t.sourceName,{tiles:[t.url],type:"vector",minzoom:t.minZoom,maxzoom:t.maxZoom,bounds:t.bounds}))}),{}),o=Object.keys(t).reduce((function(a,n){var o=[{id:"VBET_".concat(t[n].name,"_fill"),type:"fill",source:t[n].sourceName,"source-layer":t[n].json.vector_layers[0].id,minzoom:e.minZoom-1,maxzoom:e.maxZoom+1,layout:{},paint:{"fill-opacity":["interpolate",["linear"],["zoom"],e.minZoom,.7,e.maxZoom,.2],"fill-color":t[n].fillColor}},{id:"VBET_".concat(t[n].name,"_lines"),type:"line",source:t[n].sourceName,"source-layer":t[n].json.vector_layers[0].id,layout:{},minzoom:e.minZoom-1,maxzoom:e.maxZoom+1,paint:{"line-color":t[n].lineColor,"line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],e.minZoom,1,e.maxZoom,2]}}];return[].concat(Object(l.a)(a),o)}),[]),r=Object(m.a)(Object(m.a)({},n),{},{hillshade:{type:"raster",tiles:["".concat("https://d2hsyhl6qlaiyu.cloudfront.net","/").concat(e.rasterTiles.Hillshade,"/{z}/{x}/{y}.png")],scheme:"tms",minzoom:5,maxzoom:12,tileSize:256},contextSource:{tiles:["".concat("https://d18emzkyqtselk.cloudfront.net","/crb/context/{z}/{x}/{y}.pbf")],type:"vector",minzoom:6,maxzoom:12,bounds:[-124.091448,41.127826,-109.762491,48.997885]}}),c=[{id:"Hillshade",type:"raster",source:"hillshade",layout:{visibility:a?"visible":"none"},paint:{}}].concat(Object(l.a)(o),[{id:"HUC8LInes",type:"line",source:"contextSource","source-layer":"huc8",layout:{},minzoom:5,maxzoom:19,paint:{"line-color":"#FF0000","line-opacity":.5,"line-width":["interpolate",["linear"],["zoom"],8,1,14,4]}},{id:"HUC8_Labels",type:"symbol",source:"contextSource","source-layer":"huc8",minzoom:5,maxzoom:19,layout:{"text-size":["interpolate",["linear"],["zoom"],8,10,14,30],"text-field":["to-string",["concat",["get","HUC8"],"\n",["get","NAME"]]]},paint:{"text-color":"#000000","text-halo-width":2,"text-halo-blur":4,"text-halo-color":"#FFFFFF"}}]);return{version:8,name:"Outdoors",metadata:{"mapbox:type":"default","mapbox:origin":"outdoors-v11","mapbox:autocomposite":!0,"mapbox:groups":{},"mapbox:sdk-support":{js:"0.50.0",android:"6.7.0",ios:"4.6.0"}},sources:Object(m.a)({},r),sprite:"mapbox://sprites/pipbailey/cjvfq2uwm0vqk1foby0dtwdmk/ayuihl2d38ufkjhmu0pwx0cto",glyphs:"mapbox://fonts/pipbailey/{fontstack}/{range}.pbf",layers:Object(l.a)(c),created:"2019-05-08T21:16:06.811Z",id:"cjvfq2uwm0vqk1foby0dtwdmk",modified:"2019-05-08T22:02:34.939Z",owner:"pipbailey",visibility:"private",draft:!1}},T=Object(E.a)((function(e){return{root:{height:"100%"},mapContainer:{height:"100%"},mapMenuContainer:{left:e.spacing(3),top:e.spacing(3)},formControl:{marginTop:e.spacing(2)}}})),P={VBET:function(e){var t=e.state,a=T(),r=Object(n.useState)(!0),c=Object(i.a)(r,2),E=c[0],O=c[1],v=Object(n.useState)(!0),S=Object(i.a)(v,2),j=S[0],P=S[1],w=Object(n.useState)(),C=Object(i.a)(w,2),R=C[0],x=C[1],k=Object(n.useState)({}),I=Object(i.a)(k,2),N=I[0],z=I[1],W=Object(n.useState)(1),M=Object(i.a)(W,2),D=M[0],L=M[1],H=Object(n.useRef)(),B=Object(n.useRef)();Object(n.useEffect)((function(){if(E){var e=Object.keys(t.tiles).map((function(e){var a=t.tiles[e],n="".concat("https://d2hsyhl6qlaiyu.cloudfront.net","/").concat(a[0],"/metadata.json");return fetch(n).then((function(e){return e.json()})).then((function(t){return Object(m.a)(Object(m.a)({},t),{},{name:e,menuName:"VBET ".concat(e,"%"),lineColor:a[1],fillColor:a[2],sourceName:"vbet_".concat(e),url:"".concat("https://d2hsyhl6qlaiyu.cloudfront.net","/").concat(a[0],"/{z}/{x}/{y}.pbf"),json:JSON.parse(t.json),minZoom:parseInt(t.minzoom,10),maxZoom:parseInt(t.maxzoom,10),bounds:JSON.parse("[".concat(t.bounds,"]")),center:JSON.parse("[".concat(t.center,"]"))})})).catch((function(e){console.log("DATA::fetch_tile::err:",e)}))}));Promise.all(e).then((function(e){y.a.debug("here",e);var a=[Math.min.apply(Math,Object(l.a)(e.map((function(e){return e.bounds[0]})))),Math.min.apply(Math,Object(l.a)(e.map((function(e){return e.bounds[1]})))),Math.max.apply(Math,Object(l.a)(e.map((function(e){return e.bounds[2]})))),Math.max.apply(Math,Object(l.a)(e.map((function(e){return e.bounds[3]}))))];x({bounds:a,maxZoom:Math.max.apply(Math,[13].concat(Object(l.a)(e.map((function(e){return e.maxZoom}))))),minZoom:Math.min.apply(Math,[5].concat(Object(l.a)(e.map((function(e){return e.minZoom}))))),zoom:Math.min.apply(Math,Object(l.a)(e.map((function(e){return e.minZoom})))),longitude:(a[0]+a[2])/2,latitude:(a[1]+a[3])/2,rasterTiles:t.rasterTiles,tiles:e}),z(Object(s.a)({},e[0].name,e[0])),O(!1)})).catch((function(e){O(!1)}))}}),[t.rasterTiles,t.tiles,E]);var U=Object(n.useMemo)((function(){if(!R)return null;var e,t,a=A(R,N,j);return e=g.MapStyles[D].style,t=a,y.a.debug("combineStyles",{base:e,merge:t}),Object(m.a)(Object(m.a)({},e),{},{sources:Object(m.a)(Object(m.a)({},e.sources),t.sources),layers:[].concat(Object(l.a)(e.layers),Object(l.a)(t.layers))})}),[D,N,j,R]);return E||!R?o.a.createElement("div",null,"loading..."):o.a.createElement("div",{className:a.mapContainer},o.a.createElement(g.BaseMap,{lockToBounds:!0,mapBoxToken:_,reactMapGLProps:{maxZoom:R.maxZoom,minZoom:R.minZoom},bounds:R.bounds,viewport:{zoom:R.zoom||12,latitude:R.latitude,longitude:R.longitude},onViewportChange:function(e){var t=e.viewport,a=t.latitude,n=t.longitude,o=t.zoom,r=(e.size,e.projection,e.map);H.current||(H.current=r),B.current=o,console.log("zoom",a,n,o)},mapStyles:[{style:U}]},o.a.createElement(g.MapPaper,{className:a.mapMenuContainer},o.a.createElement(b.a,{color:"error"},o.a.createElement("strong",null,"WARNING"),": Model result are not verified. Do not use for anything important."),o.a.createElement(u.a,{component:"fieldset",className:a.formControl},o.a.createElement(p.a,{component:"legend"},"Thresholding"),o.a.createElement(d.a,null,R.tiles.map((function(e,t){return o.a.createElement(h.a,{onClick:function(){return function(e){var t=Object(m.a)({},N);y.a.info("TEST",t,e),N[e.name]?delete t[e.name]:t[e.name]=e,z(t)}(e)},key:"control-check-".concat(t),control:o.a.createElement(f.a,{checked:Boolean(N[e.name])}),label:e.menuName})})))),o.a.createElement(u.a,{component:"fieldset",className:a.formControl},o.a.createElement(d.a,null,o.a.createElement(h.a,{onClick:function(){return P(!j)},control:o.a.createElement(f.a,{checked:j}),label:"Hillshade Raster"}))),o.a.createElement(g.Legend,{legend:Object.keys(N).map((function(e){return{label:N[e].menuName,color:N[e].fillColor}}))})),o.a.createElement(g.StyleButtons,{currStyle:D,mapStyles:g.MapStyles,setCurrStyle:function(e){return L(e||0)}})))}},w=a(884),C=a(396),R=a(391),x=a(392),k=Object(E.a)((function(e){return{root:{display:"flex",alignItems:"center",width:"100%",padding:e.spacing(0,1),textShadow:"3px 3px 3px rgba(0,0,0,0.7)",backgroundImage:"url(https://northarrowresearchlabs.github.io/riverscapes/HeaderBackground.png)",backgroundRepeat:"no-repeat",backgroundPosition:"0% 50%",backgroundSize:"cover",backgroundColor:"#444444"},spacer:{flexGrow:1},logo:{height:40,width:40,marginRight:e.spacing(2)}}})),I=function(e){var t=e.title,a=e.signOutHandler,n=(e.history,k());return o.a.createElement(o.a.Fragment,null,o.a.createElement(R.a,{position:"static"},o.a.createElement(C.a,{className:n.root,disableGutters:!0},o.a.createElement("a",{href:"http://riverscapes.xyz/"},o.a.createElement("img",{className:n.logo,src:"https://riverscapes.xyz/assets/images/RiverscapesLogo.png",alt:"logo"})),o.a.createElement(b.a,{variant:"subtitle1"},t),o.a.createElement("div",{className:n.spacer}),a&&o.a.createElement(x.a,{onClick:function(){return a()},color:"inherit"},"Sign Out"))))},N=a(125),z=a(157),W=a(162),M=a(165),D={palette:{primary:{main:W.a[500]},secondary:{main:M.a[600],contrastText:"#FFFFFF"},text:{}}},L=Object(m.a)(Object(m.a)({},D),{},{palette:Object(m.a)(Object(m.a)({},D.palette),{},{type:"dark"})}),H={home:Object(z.a)(D),homeDark:Object(z.a)(L)},B=function(e){var t=e.children,a=e.history,n=e.signOut,r=e.containerProps,c=e.title;return o.a.createElement(w.a,{theme:H.home},o.a.createElement(N.AppFrame,{containerProps:r,noScroll:!0,fullWidth:!0,topbar:o.a.createElement(I,{history:a,title:c||"Riverscapes Maps",signOutHandler:n})},t))},U=a(497),F=a(199),Z=a(492),V=a(390),Y=a(297),q=a(393),K=a(394),X=a(890),G=Object(E.a)((function(e){return{container:{height:"100%",display:"flex",flexDirection:"column"},spacer:{flexGrow:1},root:{padding:e.spacing(2),margin:e.spacing(2)},logo:{},logoContainer:{padding:e.spacing(2),textAlign:"center"}}})),J=function(e){var t=e.maps,a=e.changeMaps,n=G();return o.a.createElement(V.a,{maxWidth:"sm",className:n.container},o.a.createElement("div",{className:n.spacer}),o.a.createElement(F.a,{className:n.root,elevation:1},o.a.createElement("div",{className:n.logoContainer},o.a.createElement("img",{className:n.logo,src:"/RiverscapesLogo.png",alt:"logo"})),o.a.createElement(b.a,{variant:"h5"},"Choose a map:"),o.a.createElement(Y.a,null,t&&t.map((function(e,t){return o.a.createElement(q.a,{key:"progKey-".concat(t),button:!0,divider:!0,onClick:function(){return a(e.url)}},o.a.createElement(X.a,null,o.a.createElement(Z.a,{alt:"programname"},e.title.substr(0,1))),o.a.createElement(K.a,{primary:e.title}))})))),o.a.createElement("div",{className:n.spacer}))};Object(N.devSetup)();var Q=function(e){var t=e.location,a=e.history,r=Object(n.useState)([]),c=Object(i.a)(r,2),s=c[0],l=c[1],m=Object(n.useState)(),u=Object(i.a)(m,2),p=u[0],d=u[1],h=Object(n.useState)(!0),f=Object(i.a)(h,2),b=f[0],g=f[1],E=Object(U.useHosted)(j,!0,!0),O=E.isAuthenticated,_=E.signOut,S=null;try{S=t.pathname.split("/").filter((function(e){return e.length>0}))[0]}catch(w){}Object(n.useEffect)((function(){if(!S||!s||0===s.length)return document.title="RS Maps",void d(void 0);var e=s.find((function(e){return e.url===S}));document.title="RS Maps: ".concat(S),d(e)}),[s,t.pathname,S]),Object(n.useEffect)((function(){if(O){var e=new URL("".concat("","/maps.json"),window.location.href);fetch(e.href).then((function(e){return e.json()})).then((function(e){g(!1),l(e)})).catch((function(e){y.a.error(e)}))}}),[O]);var A=o.a.createElement("img",{src:"/RiverscapesLogo.png",alt:"logo"}),T=Object(n.useMemo)((function(){if(!S)return null;switch(S){case"VBET":return o.a.createElement(P.VBET,{state:p})}}),[S,p]);return b?o.a.createElement(B,null,o.a.createElement(N.Loading,{logoSVG:A,title:"Riverscapes Warehouse",message:"Loading Maps",version:v})):p&&T?o.a.createElement(B,{containerProps:{maxWidth:"sm"},signOut:_,title:p.title},T):o.a.createElement(B,{containerProps:{maxWidth:"sm"},signOut:_,title:"Riverscapes Maps"},o.a.createElement(J,{maps:s,changeMaps:function(e){return a.push("/"+e)}}))},$=a(516),ee=a(58),te=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ae(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a(836);Object(N.devSetup)(),a(837),c.a.render(o.a.createElement($.a,{basename:"/"},o.a.createElement(ee.a,{path:"*",render:function(e){return o.a.createElement(Q,e)}})),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");te?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ae(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ae(t,e)}))}}(),window.addEventListener("load",(function(){window.history.pushState({},"")})),navigator.storage&&navigator.storage.persist?navigator.storage.persist().then((function(e){e?y.a.debug("Storage will not be cleared except by explicit user action"):y.a.warn("Storage may be cleared by the UA under storage pressure.")})):y.a.warn("navigator.storage API not implemented.")}},[[535,1,2]]]);
//# sourceMappingURL=main.130dbb27.chunk.js.map