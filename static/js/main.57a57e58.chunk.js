(this["webpackJsonp@riverscapes/rs-maps"]=this["webpackJsonp@riverscapes/rs-maps"]||[]).push([[0],{325:function(e,t){},570:function(e,t,a){e.exports=a(901)},598:function(e,t){},600:function(e,t){},895:function(e,t,a){},901:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(35),c=a.n(r),i=a(50),l=a(24),s=a(77),u=a(152),m=a(132),p=function(e){var t=e.latitude,a=e.longitude,o=e.feature,r=e.onClose,c=JSON.parse(o.properties.metadata);return n.a.createElement(m.Popup,{longitude:a,latitude:t,closeButton:!0,closeOnClick:!0,onClose:r,anchor:"top"},n.a.createElement(u.a,{variant:"subtitle1",component:"div"},o.properties.obs_type),Object.keys(c).map((function(e,t){return n.a.createElement(u.a,{key:"prop-".concat(t),variant:"caption",component:"div"},n.a.createElement("strong",null,e),": ",c[e])})))},d=a(424),f=a(76),b=a(29),h=a.n(b);function g(e,t){return h.a.debug("combineStyles",{base:e,merge:t}),Object(l.a)(Object(l.a)({},e),{},{sources:Object(l.a)(Object(l.a)({},e.sources),t.sources),layers:[].concat(Object(f.a)(e.layers),Object(f.a)(t.layers))})}var y="pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",v=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_RS_TILES_CDN:"https://d2hsyhl6qlaiyu.cloudfront.net",REACT_APP_BRAT_CDN:"https://d18emzkyqtselk.cloudfront.net",REACT_APP_PUBLIC_TEGOLA:"https://bakd3xuzr8.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION_DEPLOY:"us-west-2",REACT_APP_AWS_USERPOOLID:"us-west-2_jkK8HRXBU",REACT_APP_AWS_USERPOOLWEBCLIENTID:"6spmepn7s5nddcjbmd410sq40c",REACT_APP_HOSTED_DOMAIN:"riverscapes-prod.auth.us-west-2.amazoncognito.com",REACT_APP_SHEETS_API_TOKEN:"AIzaSyDRxTH2BERkX8jg77sQkXPpO1vnSd1cFkY"}).REACT_APP_VERSION,E=(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_RS_TILES_CDN:"https://d2hsyhl6qlaiyu.cloudfront.net",REACT_APP_BRAT_CDN:"https://d18emzkyqtselk.cloudfront.net",REACT_APP_PUBLIC_TEGOLA:"https://bakd3xuzr8.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION_DEPLOY:"us-west-2",REACT_APP_AWS_USERPOOLID:"us-west-2_jkK8HRXBU",REACT_APP_AWS_USERPOOLWEBCLIENTID:"6spmepn7s5nddcjbmd410sq40c",REACT_APP_HOSTED_DOMAIN:"riverscapes-prod.auth.us-west-2.amazoncognito.com",REACT_APP_SHEETS_API_TOKEN:"AIzaSyDRxTH2BERkX8jg77sQkXPpO1vnSd1cFkY"}).REACT_APP_GRAPHQL,Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_RS_TILES_CDN:"https://d2hsyhl6qlaiyu.cloudfront.net",REACT_APP_BRAT_CDN:"https://d18emzkyqtselk.cloudfront.net",REACT_APP_PUBLIC_TEGOLA:"https://bakd3xuzr8.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION_DEPLOY:"us-west-2",REACT_APP_AWS_USERPOOLID:"us-west-2_jkK8HRXBU",REACT_APP_AWS_USERPOOLWEBCLIENTID:"6spmepn7s5nddcjbmd410sq40c",REACT_APP_HOSTED_DOMAIN:"riverscapes-prod.auth.us-west-2.amazoncognito.com",REACT_APP_SHEETS_API_TOKEN:"AIzaSyDRxTH2BERkX8jg77sQkXPpO1vnSd1cFkY"}).REACT_APP_CDN,new URL("".endsWith("/")?"":"/",window.location.origin)),O={Auth:{region:"us-west-2",userPoolId:"us-west-2_jkK8HRXBU",userPoolWebClientId:"6spmepn7s5nddcjbmd410sq40c",mandatorySignIn:!0,oauth:{domain:"riverscapes-prod.auth.us-west-2.amazoncognito.com",scope:["email","profile","openid"],redirectSignIn:E,redirectSignOut:E,responseType:"code"}}},j=Object(d.a)((function(e){return{root:{height:"100%"},mapContainer:{height:"100%"},mapMenuContainer:{left:e.spacing(3),top:e.spacing(3)},formControl:{marginTop:e.spacing(2)}}})),_=function(e){var t=e.state,a=j(),r=Object(o.useState)(!0),c=Object(i.a)(r,2),u=c[0],m=c[1],d=Object(o.useState)(),f=Object(i.a)(d,2),b=f[0],v=f[1],E=Object(o.useState)(),O=Object(i.a)(E,2),_=O[0],C=O[1],S=Object(o.useState)(),k=Object(i.a)(S,2),T=k[0],P=k[1],A=Object(o.useState)(2),x=Object(i.a)(A,2),R=x[0],z=x[1],w=Object(o.useRef)(),N=Object(o.useRef)();Object(o.useEffect)((function(){if(u){var e="".concat("https://bakd3xuzr8.execute-api.us-west-2.amazonaws.com/prod","/capabilities/observations");fetch(e).then((function(e){return e.json()})).then((function(e){C(e);var a=t.tegolaTiles.observations.bounds;P({bounds:a,maxZoom:20,minZoom:6,zoom:6.1,latitude:(a[1]+a[3])/2,longitude:(a[0]+a[2])/2})})).catch((function(e){return console.error(e)})).then((function(){return m(!1)}))}}),[t.tegolaTiles,u]);var I=Object(o.useMemo)((function(){if(!_)return null;var e=function(e,t){h.a.info("BeaverObservation Map Style",e);var a=2===t,o={observations:{tiles:e.tiles,type:"vector",minzoom:e.minzoom,maxzoom:e.maxzoom,bounds:e.bounds}},n=[{id:"observations-dots",type:"symbol",source:"observations","source-layer":"observations",minzoom:e.minzoom,layout:{"icon-image":["step",["zoom"],"circle-11",10,"attraction-11",13,"attraction-15"],"icon-allow-overlap":!0,"icon-ignore-placement":!0,"text-size":["step",["zoom"],9,11,11],"text-offset":["step",["zoom"],["literal",[0,.3]],7,["literal",[0,.7]]],"text-anchor":["step",["zoom"],"center",5,"top"],"text-field":["step",["zoom"],"",15,["get","obs_type"]]},paint:{"text-halo-color":a?"#000000":"#FFFFFF","text-halo-width":.1,"text-halo-blur":.2,"text-color":a?"#FFFFFF":"#000000"}}];return{version:8,name:"Outdoors",metadata:{},sources:Object(l.a)({},o),sprite:"mapbox://sprites/raychaser/cjngl84yw1js52rqgjswrnjq1",glyphs:"mapbox://fonts/raychaser/{fontstack}/{range}.pbf",layers:[].concat(n),created:"2019-05-08T21:16:06.811Z",id:"cjvfq2uwm0vqk1foby0dtwdmk",modified:"2019-05-08T22:02:34.939Z",visibility:"private",draft:!1}}(_,R);return g(s.MapStyles[R].style,e)}),[R,_]),L=Object(o.useCallback)((function(e,t){var a="".concat("","/all_maki_icons/png/").concat(t,".png");return new Promise((function(o,n){if(e.hasImage(t))return o();e.loadImage(a,(function(a,r){return a?(h.a.error(a),n(a)):(e.addImage(t,r),o())}))}))}),[]),H=Object(o.useCallback)((function(e){if(e){["attraction-15","attraction-11","circle-15","circle-11"].forEach((function(t){return L(e,t)}))}}),[L]);Object(o.useEffect)((function(){w.current&&H(w.current)}),[I,H]);if(u||!_||!T)return n.a.createElement("div",null,"loading...");var D=function(){if(w.current){var e=w.current;P(Object(l.a)(Object(l.a)({},T),{},{zoom:e.getZoom(),latitude:e.getCenter().lat,longitude:e.getCenter().lng}))}};return n.a.createElement("div",{className:a.mapContainer},n.a.createElement(s.BaseMap,{lockToBounds:!0,mapBoxToken:y,reactMapGLProps:{interactiveLayerIds:["observations-dots"],onClick:function(e){e.features&&e.features.length>0&&(D(),v(e))},maxZoom:T.maxZoom,minZoom:T.minZoom},bounds:T.bounds,viewport:{zoom:T.zoom,latitude:T.latitude,longitude:T.longitude},onViewportChange:function(e){var t=e.viewport,a=t.latitude,o=t.longitude,n=t.zoom,r=(e.size,e.projection,e.map);w.current||(w.current=r,H(r)),N.current=n,h.a.debug("zoom",a,o,n)},mapStyles:[{style:I}]},b&&n.a.createElement(p,{longitude:b.lngLat[0],latitude:b.lngLat[1],feature:b.features[0],onClose:function(){D(),v(null)}}),n.a.createElement(s.StyleButtons,{currStyle:R,mapStyles:s.MapStyles,setCurrStyle:function(e){D(),z(e||0)}})))},C=a(168),S=a(331),k=a(920),T=a(918),P=a(952),A=a(954),x=function(e,t,a){var o=e.tiles.reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(C.a)({},t.sourceName,{tiles:[t.url],type:"vector",minzoom:t.minZoom,maxzoom:t.maxZoom,bounds:t.bounds}))}),{}),n=Object.keys(t).reduce((function(a,o){var n=[{id:"VBET_".concat(t[o].name,"_fill"),type:"fill",source:t[o].sourceName,"source-layer":t[o].json.vector_layers[0].id,minzoom:e.minZoom-1,maxzoom:e.maxZoom+1,layout:{},paint:{"fill-opacity":["interpolate",["linear"],["zoom"],e.minZoom,.7,e.maxZoom,.2],"fill-color":t[o].fillColor}},{id:"VBET_".concat(t[o].name,"_lines"),type:"line",source:t[o].sourceName,"source-layer":t[o].json.vector_layers[0].id,layout:{},minzoom:e.minZoom-1,maxzoom:e.maxZoom+1,paint:{"line-color":t[o].lineColor,"line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],e.minZoom,1,e.maxZoom,2]}}];return[].concat(Object(f.a)(a),n)}),[]),r=Object(l.a)(Object(l.a)({},o),{},{hillshade:{type:"raster",tiles:["".concat("https://d2hsyhl6qlaiyu.cloudfront.net","/").concat(e.rasterTiles.Hillshade,"/{z}/{x}/{y}.png")],scheme:"tms",minzoom:5,maxzoom:12,tileSize:256},contextSource:{tiles:["".concat("https://d18emzkyqtselk.cloudfront.net","/crb/context/{z}/{x}/{y}.pbf")],type:"vector",minzoom:6,maxzoom:12,bounds:[-124.091448,41.127826,-109.762491,48.997885]}}),c=[{id:"Hillshade",type:"raster",source:"hillshade",layout:{visibility:a?"visible":"none"},paint:{}}].concat(Object(f.a)(n),[{id:"HUC8LInes",type:"line",source:"contextSource","source-layer":"huc8",layout:{},minzoom:5,maxzoom:19,paint:{"line-color":"#FF0000","line-opacity":.5,"line-width":["interpolate",["linear"],["zoom"],8,1,14,4]}},{id:"HUC8_Labels",type:"symbol",source:"contextSource","source-layer":"huc8",minzoom:5,maxzoom:19,layout:{"text-size":["interpolate",["linear"],["zoom"],8,10,14,30],"text-field":["to-string",["concat",["get","HUC8"],"\n",["get","NAME"]]]},paint:{"text-color":"#000000","text-halo-width":2,"text-halo-blur":4,"text-halo-color":"#FFFFFF"}}]);return{version:8,name:"Outdoors",metadata:{"mapbox:type":"default","mapbox:origin":"outdoors-v11","mapbox:autocomposite":!0,"mapbox:groups":{},"mapbox:sdk-support":{js:"0.50.0",android:"6.7.0",ios:"4.6.0"}},sources:Object(l.a)({},r),sprite:"mapbox://sprites/pipbailey/cjvfq2uwm0vqk1foby0dtwdmk/ayuihl2d38ufkjhmu0pwx0cto",glyphs:"mapbox://fonts/pipbailey/{fontstack}/{range}.pbf",layers:Object(f.a)(c),created:"2019-05-08T21:16:06.811Z",id:"cjvfq2uwm0vqk1foby0dtwdmk",modified:"2019-05-08T22:02:34.939Z",owner:"pipbailey",visibility:"private",draft:!1}},R=Object(d.a)((function(e){return{root:{height:"100%"},mapContainer:{height:"100%"},mapMenuContainer:{left:e.spacing(3),top:e.spacing(3)},formControl:{marginTop:e.spacing(2)}}})),z=function(e){var t=e.state,a=R(),r=Object(o.useState)(!0),c=Object(i.a)(r,2),m=c[0],p=c[1],d=Object(o.useState)(!0),b=Object(i.a)(d,2),v=b[0],E=b[1],O=Object(o.useState)(),j=Object(i.a)(O,2),_=j[0],z=j[1],w=Object(o.useState)({}),N=Object(i.a)(w,2),I=N[0],L=N[1],H=Object(o.useState)(1),D=Object(i.a)(H,2),B=D[0],M=D[1],F=Object(o.useRef)(),U=Object(o.useRef)();Object(o.useEffect)((function(){if(m){var e=Object.keys(t.tiles).map((function(e){var a=t.tiles[e],o="".concat("https://d2hsyhl6qlaiyu.cloudfront.net","/").concat(a[0],"/metadata.json");return fetch(o).then((function(e){return e.json()})).then((function(t){return Object(l.a)(Object(l.a)({},t),{},{name:e,menuName:"VBET ".concat(e,"%"),lineColor:a[1],fillColor:a[2],sourceName:"vbet_".concat(e),url:"".concat("https://d2hsyhl6qlaiyu.cloudfront.net","/").concat(a[0],"/{z}/{x}/{y}.pbf"),json:JSON.parse(t.json),minZoom:parseInt(t.minzoom,10),maxZoom:parseInt(t.maxzoom,10),bounds:JSON.parse("[".concat(t.bounds,"]")),center:JSON.parse("[".concat(t.center,"]"))})})).catch((function(e){h.a.error("DATA::fetch_tile::err:",e)}))}));Promise.all(e).then((function(e){var a=[Math.min.apply(Math,Object(f.a)(e.map((function(e){return e.bounds[0]})))),Math.min.apply(Math,Object(f.a)(e.map((function(e){return e.bounds[1]})))),Math.max.apply(Math,Object(f.a)(e.map((function(e){return e.bounds[2]})))),Math.max.apply(Math,Object(f.a)(e.map((function(e){return e.bounds[3]}))))];z({bounds:a,maxZoom:Math.max.apply(Math,[13].concat(Object(f.a)(e.map((function(e){return e.maxZoom}))))),minZoom:Math.min.apply(Math,[5].concat(Object(f.a)(e.map((function(e){return e.minZoom}))))),zoom:Math.min.apply(Math,Object(f.a)(e.map((function(e){return e.minZoom})))),longitude:(a[0]+a[2])/2,latitude:(a[1]+a[3])/2,rasterTiles:t.rasterTiles,tiles:e}),L(Object(C.a)({},e[0].name,e[0])),p(!1)})).catch((function(e){p(!1)}))}}),[t.rasterTiles,t.tiles,m]);var W=Object(o.useMemo)((function(){if(!_)return null;var e=x(_,I,v);return g(s.MapStyles[B].style,e)}),[B,I,v,_]);return m||!_?n.a.createElement("div",null,"loading..."):n.a.createElement("div",{className:a.mapContainer},n.a.createElement(s.BaseMap,{lockToBounds:!0,mapBoxToken:y,reactMapGLProps:{maxZoom:_.maxZoom,minZoom:_.minZoom},bounds:_.bounds,viewport:{zoom:_.zoom||12,latitude:_.latitude,longitude:_.longitude},onViewportChange:function(e){var t=e.viewport,a=t.latitude,o=t.longitude,n=t.zoom,r=(e.size,e.projection,e.map);F.current||(F.current=r),U.current=n,h.a.debug("zoom",a,o,n)},mapStyles:[{style:W}]},n.a.createElement(s.MapPaper,{className:a.mapMenuContainer},n.a.createElement(u.a,{color:"error"},n.a.createElement("strong",null,"WARNING"),": Model result are not verified. Do not use for anything important."),n.a.createElement(S.a,{component:"fieldset",className:a.formControl},n.a.createElement(k.a,{component:"legend"},"Thresholding"),n.a.createElement(T.a,null,_.tiles.map((function(e,t){return n.a.createElement(P.a,{onClick:function(){return function(e){var t=Object(l.a)({},I);if(I[e.name]?delete t[e.name]:t[e.name]=e,F.current){var a=F.current;z(Object(l.a)(Object(l.a)({},_),{},{zoom:a.getZoom(),latitude:a.getCenter().lat,longitude:a.getCenter().lng}))}L(t)}(e)},key:"control-check-".concat(t),control:n.a.createElement(A.a,{checked:Boolean(I[e.name])}),label:e.menuName})})))),n.a.createElement(S.a,{component:"fieldset",className:a.formControl},n.a.createElement(T.a,null,n.a.createElement(P.a,{onClick:function(){return E(!v)},control:n.a.createElement(A.a,{checked:v}),label:"Hillshade Raster"}))),n.a.createElement(s.Legend,{legend:Object.keys(I).map((function(e){return{label:I[e].menuName,color:I[e].fillColor}}))})),n.a.createElement(s.StyleButtons,{currStyle:B,mapStyles:s.MapStyles,setCurrStyle:function(e){return M(e||0)}})))},w=a(210),N=a(530),I=a(426),L=a(333),H=a(429),D=a(430),B=a(953),M=Object(d.a)((function(e){return{container:{height:"100%",display:"flex",flexDirection:"column"},spacer:{flexGrow:1},root:{padding:e.spacing(2),margin:e.spacing(2)},logo:{},logoContainer:{padding:e.spacing(2),textAlign:"center"}}})),F=function(e){var t=e.maps,a=e.changeMaps,o=M();return n.a.createElement(I.a,{maxWidth:"sm",className:o.container},n.a.createElement("div",{className:o.spacer}),n.a.createElement(w.a,{className:o.root,elevation:1},n.a.createElement("div",{className:o.logoContainer},n.a.createElement("img",{className:o.logo,src:"/RiverscapesLogo.png",alt:"logo"})),n.a.createElement(u.a,{variant:"h5"},"Choose a map:"),n.a.createElement(L.a,null,t&&t.map((function(e,t){return n.a.createElement(H.a,{key:"progKey-".concat(t),button:!0,divider:!0,onClick:function(){return a(e.url)}},n.a.createElement(B.a,null,n.a.createElement(N.a,{alt:"programname"},e.title.substr(0,1))),n.a.createElement(D.a,{primary:e.title}))})))),n.a.createElement("div",{className:o.spacer}))},U=a(951),W={id:"bratLines",type:"line",source:"bratSource","source-layer":"brat",minzoom:5,maxzoom:19,layout:{visibility:"visible"},paint:{"line-opacity":["interpolate",["linear"],["zoom"],8,0,10,1],"line-width":["interpolate",["linear"],["zoom"],8,.5,14,4]}},Z={key:"oPBRC_UI",label:"Areas Beavers Can Build Dams but Could be Undesirable",jsonFieldName:"Risks",unit:"Km",lookup:!0,legend:[{label:"Negligible Risk",color:"#c5c5c5",value:1},{label:"Some Risk",color:"#fba12c",value:2},{label:"Minor Risk",color:"#26bcf8",value:3},{label:"Considerable Risk",color:"#e01f18",value:4}],layer:Object(l.a)(Object(l.a)({},W),{},{paint:Object(l.a)(Object(l.a)({},W.paint),{},{"line-color":["step",["get","oPBRC_UI"],"#c5c5c5",2,"#fba12c",3,"#26bcf8",4,"#e01f18"]})})},q={key:"oPBRC_CR",label:"Possible Beaver Dam Conservation/Restoration Opportunities",jsonFieldName:"Opportunities",unit:"Km",lookup:!0,legend:[{label:"Easiest - Low-Hanging Fruit",color:"#b6cb82",value:1},{label:"Straight Forward - Quick Return",color:"#2d85bc",value:2},{label:"Strategic - Long-Term Investment",color:"#2cfbc2",value:3},{label:"NA",color:"#c5c5c6",value:4}],layer:Object(l.a)(Object(l.a)({},W),{},{paint:Object(l.a)(Object(l.a)({},W.paint),{},{"line-color":["step",["get","oPBRC_CR"],"#b6cb82",2,"#2d85bc",3,"#2cfbc2",4,"#c5c5c6"]})})},V=[{key:"oCC_EX",label:"Existing Dam Build Capacity",lookup:!1,jsonFieldName:"Existing",unit:"Km",legend:[{label:"None: 0 dams/km",color:"#e52028",order:1,thresh:0},{label:"Rare: 0-1 dams/km",color:"#f69f32",order:2,thresh:1},{label:"Occasional: 1-5 dams/km",color:"#ece642",order:3,thresh:5},{label:"Frequent: 5-15 dams/km",color:"#62b448",order:4,thresh:15},{label:"Pervasive: 15-40 dams/km",color:"#3757a0",order:5,thresh:100}],layer:Object(l.a)(Object(l.a)({},W),{},{paint:Object(l.a)(Object(l.a)({},W.paint),{},{"line-color":["step",["get","oCC_EX"],"#e52028",1e-6,"#f69f32",1,"#ece642",5,"#62b448",15,"#3757a0"]})})},{key:"oCC_HPE",label:"Historic Dam Build Capacity",jsonFieldName:"Historic",unit:"Km",lookup:!1,legend:[{label:"None: 0 dams/km",color:"#e52028",order:1,thresh:0},{label:"Rare: 0-1 dams/km",color:"#f69f32",order:2,thresh:1},{label:"Occasional: 1-5 dams/km",color:"#ece642",order:3,thresh:5},{label:"Frequent: 5-15 dams/km",color:"#62b448",order:4,thresh:15},{label:"Pervasive: 15-40 dams/km",color:"#3757a0",order:5,thresh:100}],layer:Object(l.a)(Object(l.a)({},W),{},{paint:Object(l.a)(Object(l.a)({},W.paint),{},{"line-color":["step",["get","oCC_HPE"],"#e52028",1e-6,"#f69f32",1,"#ece642",5,"#62b448",15,"#3757a0"]})})},Z,q],K=function(e){var t=V.find((function(t){return t.key===e})).layer;return t.interactive=!0,t.interactive=!0,[t]},Y=a(185),X=Object(d.a)((function(e){return{root:{},title:{padding:e.spacing(1)}}})),G=function(e){var t=e.currHuc8,a=e.data,o=e.radioVal,r=X();if(!a)return n.a.createElement("div",null,"Loading...");if(0===Object.keys(a).length)return null;var c=V.find((function(e){return e.key===o})),i={};try{i=a[t.HUC8][c.jsonFieldName]}catch(s){}var l=c.legend.map((function(e){return{title:e.label,value:i[e.value]?i[e.value]:null,color:e.color}})).reverse();return h.a.debug("CHART DEBUG",{currHuc8:t,data:a,radioVal:o,chartData:l}),n.a.createElement(w.a,{className:r.root,elevation:1},n.a.createElement("div",{className:r.title},n.a.createElement(u.a,{variant:"h5"},t.NAME),n.a.createElement(u.a,{variant:"caption"},t.HUC8)),n.a.createElement(Y.d,{yType:"ordinal",margin:{left:10},width:350,height:150,colorType:"category",colorDomain:l.map((function(e,t){return t})),colorRange:l.map((function(e){return e.color}))},n.a.createElement(Y.b,null),n.a.createElement(Y.c,{title:c.unit}),n.a.createElement(Y.e,{hideTicks:!0}),n.a.createElement(Y.a,{className:"vertical-bar-data",data:l.map((function(e,t){var a=e.title,o=e.value;e.color;return{x:o,y:a,color:t}}))})))},J=a(335),Q=a.n(J),$=a(431),ee=a(955),te=a(9),ae=Object(te.a)((function(e){return{root:{padding:e.spacing(2)},optLabel:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}}}))((function(e){var t=e.classes,a=e.radioVal,o=e.setRadioIdx,r=e.allVals;return n.a.createElement("div",{className:t.root},n.a.createElement($.a,{className:t.group,value:a,onChange:function(e,t){return o(t)}},r.map((function(e,a){return n.a.createElement(P.a,{classes:{label:t.optLabel},key:"formcontrol".concat(a),value:e.key,control:n.a.createElement(ee.a,null),label:e.label})}))))})),oe=Object(d.a)((function(e){return{root:{height:"100%"},mapContainer:{height:"100%"},mapMenuContainer:{position:"absolute",left:e.spacing(3),top:e.spacing(3),maxWidth:"40%",width:350}}})),ne=function(e){var t=e.state,a=oe(),r=Object(o.useState)(),c=Object(i.a)(r,2),p=c[0],d=c[1],b=Object(o.useState)(),v=Object(i.a)(b,2),E=v[0],O=v[1],j=Object(o.useState)(V[0].key),_=Object(i.a)(j,2),C=_[0],S=_[1],k=Object(o.useState)(),T=Object(i.a)(k,2),P=T[0],A=T[1],x=Object(o.useState)(2),R=Object(i.a)(x,2),z=R[0],N=R[1],I=Object(o.useRef)(),L=Object(o.useRef)(),H=Object(o.useState)(null),D=Object(i.a)(H,2),B=D[0],M=D[1],F=Object(o.useState)(null),W=Object(i.a)(F,2),Z=W[0],q=W[1],Y=Object(o.useState)(null),X=Object(i.a)(Y,2),J=X[0],$=X[1],ee=V.find((function(e){return e.key===C}));Object(o.useEffect)((function(){var e="".concat("https://d18emzkyqtselk.cloudfront.net","/").concat(t.layers.huc8summary);fetch(e).then((function(e){return e.json()})).then(d).catch((function(e){d({}),h.a.error("DATA::brat_summary::err:",e)}));var a="".concat("https://d18emzkyqtselk.cloudfront.net","/").concat(t.layers.bratSourceTiles,"/metadata.json"),o="".concat("https://d18emzkyqtselk.cloudfront.net","/").concat(t.layers.contextSourceTiles,"/metadata.json");Promise.all([fetch(a).then((function(e){return e.json()})),fetch(o).then((function(e){return e.json()}))]).then((function(e){O({bounds:t.map.bounds,maxZoom:t.map.maxZoom,minZoom:t.map.minZoom,zoom:t.map.zoom,latitude:t.map.latitude,longitude:t.map.longitude}),A({brat:Object(l.a)(Object(l.a)({url:"".concat("https://d18emzkyqtselk.cloudfront.net","/").concat(t.layers.bratSourceTiles)},e[0]),{},{json:JSON.parse(e[0].json)}),context:Object(l.a)(Object(l.a)({url:"".concat("https://d18emzkyqtselk.cloudfront.net","/").concat(t.layers.contextSourceTiles)},e[1]),{},{json:JSON.parse(e[1].json)})})}))}),[t]),Object(o.useEffect)((function(){var e="".concat("https://d18emzkyqtselk.cloudfront.net","/").concat(t.layers.huc8summary);fetch(e).then((function(e){return e.json()})).then(d).catch((function(e){d({}),h.a.error("DATA::brat_summary::err:",e)})),t.lookups&&fetch("".concat("https://d18emzkyqtselk.cloudfront.net","/").concat(t.lookups)).then((function(e){return e.json()})).then((function(e){h.a.debug("Got Lookups:",e)})).catch((function(e){d({}),h.a.error("DATA::brat_summary::err:",e)}))}),[t]);var te=Object(o.useMemo)((function(){if(P){var e=function(e,t,a){var o=K(e),n=t.brat,r=t.context,c={bratSource:{tiles:["".concat(n.url,"/{z}/{x}/{y}.pbf")],type:"vector",minzoom:parseInt(n.minzoom,10),maxzoom:parseInt(n.maxzoom,10),bounds:JSON.parse("[".concat(n.bounds,"]"))},contextSource:{tiles:["".concat(r.url,"/{z}/{x}/{y}.pbf")],type:"vector",minzoom:parseInt(r.minzoom,10),maxzoom:parseInt(r.maxzoom,10),bounds:JSON.parse("[".concat(r.bounds,"]"))},damCensus:{type:"geojson",data:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_RS_TILES_CDN:"https://d2hsyhl6qlaiyu.cloudfront.net",REACT_APP_BRAT_CDN:"https://d18emzkyqtselk.cloudfront.net",REACT_APP_PUBLIC_TEGOLA:"https://bakd3xuzr8.execute-api.us-west-2.amazonaws.com/prod",REACT_APP_AWS_REGION_DEPLOY:"us-west-2",REACT_APP_AWS_USERPOOLID:"us-west-2_jkK8HRXBU",REACT_APP_AWS_USERPOOLWEBCLIENTID:"6spmepn7s5nddcjbmd410sq40c",REACT_APP_HOSTED_DOMAIN:"riverscapes-prod.auth.us-west-2.amazoncognito.com",REACT_APP_SHEETS_API_TOKEN:"AIzaSyDRxTH2BERkX8jg77sQkXPpO1vnSd1cFkY"}).REACT_APP_CDN,"/").concat(a)}},i=[{id:"HUC8Fill",type:"fill",source:"contextSource","source-layer":"huc8",minzoom:5,maxzoom:10.2,layout:{},paint:{"fill-opacity":["interpolate",["linear"],["zoom"],6,.5,10,0],"fill-color":"hsl(0, 0%, 59%)"},interactive:!0},{id:"HUC8Fill_Highlighted",type:"fill",source:"contextSource","source-layer":"huc8",minzoom:5,maxzoom:19,layout:{},paint:{"fill-opacity":["interpolate",["linear"],["zoom"],6,.5,10,.05],"fill-color":"#ee00ff"},filter:["in","HUC8",""]},{id:"HUC8LInes",type:"line",source:"contextSource","source-layer":"huc8",layout:{},minzoom:5,maxzoom:19,paint:{"line-color":"hsl(0, 0%, 100%)","line-opacity":.5,"line-width":["interpolate",["linear"],["zoom"],8,1,14,4]}},{id:"HUC8LInes_HighLighted",type:"line",source:"contextSource","source-layer":"huc8",layout:{},minzoom:5,maxzoom:19,paint:{"line-width":["interpolate",["linear"],["zoom"],8,1,14,5],"line-color":"#ee00ff","line-opacity":1},filter:["in","HUC8",""]}].concat(Object(f.a)(o),[{id:"HUC8_Labels",type:"symbol",source:"contextSource","source-layer":"huc8",minzoom:5,maxzoom:19,layout:{"text-size":["interpolate",["linear"],["zoom"],8,10,14,30],"text-field":["to-string",["get","NAME"]]},paint:{"text-color":"#FFFFFF","text-halo-width":2,"text-halo-blur":4,"text-halo-color":"hsl(0, 100%, 0%)"}},{id:"Census",type:"circle",source:"damCensus",minzoom:10,maxzoom:19,paint:{"circle-radius":5,"circle-color":"#DDDDDD","circle-stroke-width":1,"circle-stroke-color":"black"},interactive:!0},{id:"STATE",type:"line",metadata:{},source:"contextSource","source-layer":"state",layout:{},minzoom:5,maxzoom:19,paint:{"line-color":"hsl(0, 100%, 34%)","line-width":4}}]);return{version:8,name:"Outdoors",metadata:{"mapbox:type":"default","mapbox:origin":"outdoors-v11","mapbox:autocomposite":!0,"mapbox:groups":{},"mapbox:sdk-support":{js:"0.50.0",android:"6.7.0",ios:"4.6.0"}},sources:Object(l.a)({},c),sprite:"mapbox://sprites/pipbailey/cjvfq2uwm0vqk1foby0dtwdmk/ayuihl2d38ufkjhmu0pwx0cto",glyphs:"mapbox://fonts/pipbailey/{fontstack}/{range}.pbf",layers:Object(f.a)(i),created:"2019-05-08T21:16:06.811Z",id:"cjvfq2uwm0vqk1foby0dtwdmk",modified:"2019-05-08T22:02:34.939Z",owner:"pipbailey",visibility:"private",draft:!1}}(C,P,t.layers.census);return g(s.MapStyles[z].style,e)}}),[z,P,C,t]),ne=function(){if(I.current){var e=I.current;O(Object(l.a)(Object(l.a)({},E),{},{zoom:e.getZoom(),latitude:e.getCenter().lat,longitude:e.getCenter().lng}))}};return P&&E?n.a.createElement("div",{className:a.mapContainer},n.a.createElement(s.BaseMap,{lockToBounds:!0,mapBoxToken:y,bounds:E.bounds,reactMapGLProps:{onHover:function(e){var t=function(e){if(e&&e.features&&0!==e.features.length)return{bratFeatures:e.features.filter((function(e){return"brat"===e.sourceLayer})),censusFeatures:e.features.filter((function(e){return"damCensus"===e.source})),hucFeature:e.features.find((function(e){return"huc8"===e.sourceLayer}))}}(e);if(t){ne();var a=t.bratFeatures,o=t.hucFeature;if(o&&(!J||o.properties.HUC8!==J.HUC8)&&($(o.properties),I.current)){var n=I.current;n.setFilter("HUC8LInes_HighLighted",["in","HUC8",o.properties.HUC8]),n.setFilter("HUC8Fill_Highlighted",["in","HUC8",o.properties.HUC8])}if(L.current>9.5&&a.length>0){var r=e.lngLat;h.a.debug("setMarker",{features:a,lngLat:r}),q({features:a,lngLat:r})}else q(null)}},clickRadius:2,maxZoom:E.maxZoom,minZoom:E.minZoom},viewport:{zoom:E.zoom,latitude:E.latitude,longitude:E.longitude},onViewportChange:function(e){var t=e.viewport,a=t.latitude,o=t.longitude,n=t.zoom,r=(e.size,e.projection,e.map);I.current||(I.current=r),L.current=n,h.a.debug("zoom",a,o,n)},mapStyles:[{style:te}]},n.a.createElement(w.a,{className:a.mapMenuContainer,elevation:1,onPointerMove:function(e){e.preventDefault(),e.stopPropagation()},onMouseEnter:function(e){e.preventDefault(),e.stopPropagation()},onMouseOver:function(e){e.preventDefault(),e.stopPropagation()},onClick:function(e){e.preventDefault(),e.stopPropagation()}},n.a.createElement(ae,{radioVal:C,setRadioIdx:function(e){if(S(e),I.current){var t=I.current;K(e).reverse().forEach((function(e){t.getLayer(e.id)&&t.removeLayer(e.id),t.addLayer(e,"HUC8_Labels")}))}},allVals:V}),J&&n.a.createElement(G,{currHuc8:J,data:p,radioVal:C}),n.a.createElement(s.Legend,{legend:ee.legend})),n.a.createElement(s.StyleButtons,{currStyle:z,mapStyles:s.MapStyles,setCurrStyle:function(e){ne(),N(e||0)}}),L.current>=10&&Z&&n.a.createElement(m.Marker,{longitude:Z.lngLat[0],latitude:Z.lngLat[1]},n.a.createElement("svg",{className:a.svgArc,version:"1.1",onClick:function(){return M(Z)},width:L.current,height:L.current,style:{transform:"translateY(-50%) translateX(-50%)"},viewBox:"0, 0, 100, 100"},n.a.createElement("circle",{cx:"50",cy:"50",r:"49",fill:"white",strokeWidth:"1",stroke:"black"}))),L.current>=10&&B&&n.a.createElement(m.Popup,{longitude:B.lngLat[0],latitude:B.lngLat[1],closeButton:!0,closeOnClick:!0,onClose:function(){ne(),M(null)},anchor:"top"},B.features.map((function(e,t){var a=null,o=e.properties[C];try{a=ee.lookup?ee.legend.find((function(e){return o===e.value})):ee.legend.find((function(e){return o<=e.thresh}))}catch(r){h.a.error(r)}return n.a.createElement(n.a.Fragment,{key:"popupfeature".concat(t)},t>0&&n.a.createElement(U.a,null),n.a.createElement("div",null,n.a.createElement(u.a,{variant:"overline"},"ReachId ",e.properties.ReachID),!ee.lookup&&n.a.createElement(u.a,{variant:"body1"},"Value: ",Q()(o).format("0,0")),a&&n.a.createElement(u.a,{variant:"body2"},a.label)))}))))):n.a.createElement("div",null,"loading...")},re={VBET:z,BeaverObservation:_,BRAT:function(e){e.state;var t=e.location,a=e.history,r=Object(o.useState)(),c=Object(i.a)(r,2),l=c[0],s=c[1],u=null,m=null;try{u=t.pathname.split("/").filter((function(e){return e.length>0}))[0],m=t.pathname.split("/").filter((function(e){return e.length>1}))[1]}catch(p){}return Object(o.useEffect)((function(){var e=new URL("".concat("","/brat_states.json"),window.location.href);fetch(e.href).then((function(e){return e.json()})).then(s)}),[]),l?m?n.a.createElement(ne,{state:l.find((function(e){return e.url===m}))}):n.a.createElement(F,{maps:l,changeMaps:function(e){return a.push("/".concat(u,"/").concat(e))}}):n.a.createElement("div",null,"Loading...")}},ce=a(947),ie=a(433),le=a(427),se=a(428),ue=Object(d.a)((function(e){return{root:{display:"flex",alignItems:"center",width:"100%",padding:e.spacing(0,1),textShadow:"3px 3px 3px rgba(0,0,0,0.7)",backgroundImage:"url(".concat("","/HeaderBackground.png)"),backgroundRepeat:"no-repeat",backgroundPosition:"0% 50%",backgroundSize:"cover",backgroundColor:"#444444"},spacer:{flexGrow:1},logo:{height:40,width:40,marginRight:e.spacing(2)}}})),me=function(e){var t=e.title,a=e.signOutHandler,o=(e.history,ue());return n.a.createElement(n.a.Fragment,null,n.a.createElement(le.a,{position:"static"},n.a.createElement(ie.a,{className:o.root,disableGutters:!0},n.a.createElement("a",{href:"http://riverscapes.xyz/"},n.a.createElement("img",{className:o.logo,src:"https://riverscapes.xyz/assets/images/RiverscapesLogo.png",alt:"logo"})),n.a.createElement(u.a,{variant:"subtitle1"},t),n.a.createElement("div",{className:o.spacer}),a&&n.a.createElement(se.a,{onClick:function(){return a()},color:"inherit"},"Sign Out"))))},pe=a(127),de=a(166),fe=a(171),be=a(174),he={palette:{primary:{main:fe.a[500]},secondary:{main:be.a[600],contrastText:"#FFFFFF"},text:{}}},ge=Object(l.a)(Object(l.a)({},he),{},{palette:Object(l.a)(Object(l.a)({},he.palette),{},{type:"dark"})}),ye={home:Object(de.a)(he),homeDark:Object(de.a)(ge)},ve=function(e){var t=e.children,a=e.history,o=e.signOut,r=e.containerProps,c=e.title;return n.a.createElement(ce.a,{theme:ye.home},n.a.createElement(pe.AppFrame,{containerProps:r,noScroll:!0,fullWidth:!0,topbar:n.a.createElement(me,{history:a,title:c||"Riverscapes Maps",signOutHandler:o})},t))},Ee=a(536),Oe=Object(d.a)((function(e){return{container:{height:"100%",display:"flex",flexDirection:"column"},spacer:{flexGrow:1},root:{padding:e.spacing(2),margin:e.spacing(2)},logo:{},logoContainer:{padding:e.spacing(2),textAlign:"center"}}})),je=function(e){var t=e.maps,a=e.changeMaps,o=Oe();return n.a.createElement(I.a,{maxWidth:"sm",className:o.container},n.a.createElement("div",{className:o.spacer}),n.a.createElement(w.a,{className:o.root,elevation:1},n.a.createElement("div",{className:o.logoContainer},n.a.createElement("img",{className:o.logo,src:"/RiverscapesLogo.png",alt:"logo"})),n.a.createElement(u.a,{variant:"h5"},"Choose a map:"),n.a.createElement(L.a,null,t&&t.map((function(e,t){return n.a.createElement(H.a,{key:"progKey-".concat(t),button:!0,divider:!0,onClick:function(){return a(e.url)}},n.a.createElement(B.a,null,n.a.createElement(N.a,{alt:"programname"},e.title.substr(0,1))),n.a.createElement(D.a,{primary:e.title}))})))),n.a.createElement("div",{className:o.spacer}))};Object(pe.devSetup)();var _e=function(e){var t=e.location,a=e.history,r=Object(o.useState)([]),c=Object(i.a)(r,2),l=c[0],s=c[1],u=Object(o.useState)(),m=Object(i.a)(u,2),p=m[0],d=m[1],f=Object(o.useState)(!0),b=Object(i.a)(f,2),g=b[0],y=b[1],E=Object(Ee.useHosted)(O,!0,!0),j=E.isAuthenticated,_=E.signOut,C=null;try{C=t.pathname.split("/").filter((function(e){return e.length>0}))[0]}catch(T){}Object(o.useEffect)((function(){if(!C||!l||0===l.length)return document.title="RS Maps",void d(void 0);var e=l.find((function(e){return e.url===C}));document.title="".concat(e?e.title:"RS Maps"),d(e||void 0)}),[l,t.pathname,C]),Object(o.useEffect)((function(){if(j){var e=new URL("".concat("","/maps.json"),window.location.href);fetch(e.href).then((function(e){return e.json()})).then((function(e){y(!1),s(e)})).catch((function(e){h.a.error(e)}))}}),[j]);var S=n.a.createElement("img",{src:"/RiverscapesLogo.png",alt:"logo"}),k=Object(o.useMemo)((function(){if(!C)return null;switch(C){case"VBET":return n.a.createElement(re.VBET,{state:p});case"beaver_observation":return n.a.createElement(re.BeaverObservation,{state:p});case"BRAT":return n.a.createElement(re.BRAT,{state:p,location:t,history:a})}}),[C,p,t,a]);return g?n.a.createElement(ve,null,n.a.createElement(pe.Loading,{logoSVG:S,title:"Riverscapes Warehouse",message:"Loading Maps",version:v})):p&&k?n.a.createElement(ve,{containerProps:{maxWidth:"sm"},signOut:_,title:p.title},k):n.a.createElement(ve,{containerProps:{maxWidth:"sm"},signOut:_,title:"Riverscapes Maps"},n.a.createElement(je,{maps:l,changeMaps:function(e){return a.push("/"+e)}}))},Ce=a(547),Se=a(59),ke=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Te(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a(895),a(896);Object(pe.devSetup)(),a(897),c.a.render(n.a.createElement(Ce.a,{basename:"/"},n.a.createElement(Se.a,{path:"*",render:function(e){return n.a.createElement(_e,e)}})),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ke?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var o=a.headers.get("content-type");404===a.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Te(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Te(t,e)}))}}(),window.addEventListener("load",(function(){window.history.pushState({},"")})),navigator.storage&&navigator.storage.persist?navigator.storage.persist().then((function(e){e?h.a.debug("Storage will not be cleared except by explicit user action"):h.a.warn("Storage may be cleared by the UA under storage pressure.")})):h.a.warn("navigator.storage API not implemented.")}},[[570,1,2]]]);
//# sourceMappingURL=main.57a57e58.chunk.js.map